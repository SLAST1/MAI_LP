# Отчет по лабораторной работе №4
## по курсу "Логическое программирование"

## Обработка естественного языка

### студент: Пивницкий Д.С.

## Результат проверки

| Преподаватель     | Дата         |  Оценка       |
|-------------------|--------------|---------------|
| Сошников Д.В. |              |               |
| Левинская М.А.|              |               |

> *Комментарии проверяющих (обратите внимание, что более подробные комментарии возможны непосредственно в репозитории по тексту программы)*

Грамматика Вашего варианта? 
## Введение

Естественный язык - это часть культурной среды. С точки зрения программиста естественный язык может быть интересен как минимум в следубщих случаях:

- как язык постановки задачи для компьютера;
- как язык ведения диалога с программой;
- как язык культурной среды программы с минимальными естественноязыковыми возможностями - для выдачи сообщений.

Любой анализ естественного языка сводиться к нескольким этапам: 
1. Предварительный анализ (поиск границ слов и предложений);
2. Морфологический анализ (установление словарных форм слов и приписывание им морфологических признаков);
3. Синтаксический анализ (зависимости между словами);
4. Семантический анализ (смысл предложения или отдельных слов). 

Грамматика описывает закономерности устройства языка, но она имеет описательный характер и, к сожалению, не всегда содержит явные и чёткие правила формирования предложений. Самой главной задачей анализа естественного языка является выявление закономерностей. В этом используется два подхода:
- работа эксперта-лингвиста,
- автоматическое исследование размеченных данных.

В данной работе будет использоватся первый подход, будет исследована ограниченная часть языка, и в ней выделены правила грамматики.  Грамматика  `G` - это  четверка  `<VT, VN, P, S>`, где

`VT` - терминальный словарь,

`VN` - нетерминальный словарь), не пересекающийся с `VT`,

`P` - множество правил вывода и записывается в виде `{ai -> bi}`,

`S` - начальный символ.

Пролог удобен для таких задач, т.к. на нём удобно описывать грамматику, она понятна человеку, который читает код, и в то же время человеку, который его пишет.

## Задание

Вариант 9

Реализовать разбор фраз языка (вопросов), выделяя в них неизвестный объект
```prolog
 Запрос:    ?- an_q(['Кто', 'любит', 'шоколад', '?'], X).
            ?- an_q(['Где', 'лежат', 'деньги', '?'], X).
            ?- an_q(['Что', 'любит', 'Даша', '?'], X).
 Результат: X='любить'(agent(Y), object('шоколад')),
            X='лежать'(object('деньги'), loc(X)),
            X='любить'(agent("Даша"), object(Y)).
```
## Принцип решения

Глубинная форма - форма содержащая в себе только смысл части предложения, без морфологических признаков, не требующая пояснения форм слов.

В нашем анализаторе будут обрабатываться упрощенные варианты вопросительных предложений, начинающихся с вопросительного слова. В зависимости от вопросительного слова будем строить глубинные структуры.
Для глаголов реализуем словарь и предикаты приведения глагола к начальной форме, то есть инфинитиву. Эти закономерности и лежат в основе программы.

Для начала напишем предикат, который поможет нам выделить в предложении отдельные элеметы.
```prolog
% Предикат выделения элемента в списке
getElem([],_,_).
getElem([H|T],T,H).

% Предикат разделения вопроса на части
split(Question,QuestionWord,Verb,Something):-
    getElem(Question,Q1,QuestionWord), 
    getElem(Q1,Q2,Verb),
    getElem(Q2,Q3,Something).
```
Предикат `split` полчает на вход  вопросительное предложение `Question` и разбивает его на три части: вопросительное слово, глагол и неопределенную часть, которая при дальнейшем анализе превратиться в `object`, `agent` или`loc`.

Реализуем предикат для анализа неопределенной части при помощи вопросительного слова.

```prolog
% Предикаты для анализа предложений с вопросительным словом 'Кто'
find_agent(QW,S):- QW == 'Кто'; entity(S).
find_agent1(QW):- QW == 'Кто'.

% Предикаты для анализа предложений с вопросительным словом 'Что'
find_object(QW,S):- QW == 'Что'; object(S).
find_object1(QW):- QW == 'Что'.

% Предикаты для анализа предложений с вопросительным словом 'Где'
find_loc(QW,S):- QW == 'Где', loc(S).
find_loc1(QW):- QW == 'Где'.
find_loc2(S):-loc(S).
```
Теперь перейдем  к анализу глагола. Генерируется словарь и вызывается функция поиска слова в словаре

`find` - Поиск слова по всему словарю.

`condition` - Поиск и выделение глубинной формы слова по конкретной строке в словаре.

```prolog
% Поиск словоформы в словаре
find(Word, CanonWord, Type, File):-
  member(X, File),
  condition(Word, CanonWord, Type, X).

condition(W, CW, T, CW:T:L):-
  member(W, L).
```

Выделяется строчка словаря и для неё вызывается `condition` для выделения глубинной формы по форме `Type`

Подробнее о структуре словаря: Для структуры словаря используется оператор `:-op(200, xfy, ':').` 

Запись в словаре имеет вид:

```
"Глубинная форма' : форма слова : [Список вариаций слова в этой форме]
% Например
'любить':infinitiv('неинф'):['любит', 'любят','любила', 'любили'],
```

Главный предикат `an_q`. Сначала мы всегда пишем наш глагол, который стоит в середине предложения, определив предварительно его каноническую форму. И дальше мы смотрим, что у нас спрашивают: чтобы это узнать, воспользуемся оператором "!", который в помогает реализовать структуру "Если ..., то ...". Соответственно, мы проверяем на то или иное вопросителное слово и так движемся по вложенной структуре, пока не закончим проверку нашего вопроса.

```prolog
% Предикат поиска неизвестного объекта в вопросе
an_q(Q):- 
  split(Q, QW, V, S), 
  verb(IV, infinitiv('неинф'), V), write(IV), 
  (find_agent(QW,S), !,
     write("(agent("), (find_agent1(QW), !, 
      write("Y),");
    write(S),write("),")), (find_loc(QW,S), !, 
      write("loc("),(find_loc1(QW), !, 
        write("Y))");
      write(S),write("))"));
    write("object("),(find_object1(QW), !, 
      write("Y))");
    write(S),write("))")));
  write("(object("),(find_object1(QW), !,
    write("Y),");
  write(S),write("),")), (write("loc("),(find_loc1(QW), !, 
    write("X))");
  write(S),write("))")))).
```

## Результаты

```prolog
?- an_q(['Кто', 'любит', 'шоколад','?']).
любить(agent(Y),object(шоколад))
true.
```

```prolog
?- an_q(['Где', 'лежат', 'деньги','?']).                                                                                                  
лежать(object(деньги),loc(X))
true.
```

```prolog
?- an_q(['Что', 'любит', 'Даша','?']).                                                                                   
любить(agent(Даша),object(Y))
true.
```

```prolog
?- an_q(['Где', 'живут', 'они','?']).                                                                                          
жить(object(они),loc(X))
true.
```

## Выводы

Выполнив данную лабораторную работу, я составил несложный фрагмент естественно-языкового интерфейса к модельной задаче. Смог реализовать грамматику для небольшой части русского языка, а именно вопросов. Написал грамматические правила для анализа глаголов и вынес их в словарь, что обеспечит возможность подключать словари и выполнять программу для различных слов.

Пролог был удобен для решения задач грамматического разбора, так как реализация правил перехода довольно очевидна и проста.

Prolog идеально подходит для обработки естественного языка, если мы знаем структуру предложений. С ее помощью мы можем написать алгоритм парсинга предложений. Использование именно этого языка во многом связано с простотой и естественностью реализации процесса переборов с возвратами, а также с удобством манипулирования символьной информацией. После выполнения данной лабораторной мне показалось, что на Prolog можно написать генератор каких-то документов или даже текстовый редактор.




